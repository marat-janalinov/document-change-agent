# Использование промптов в системе

## Промпты для проверки инструкций

Эти промпты используются в методе `_parse_changes_with_llm` класса `DocumentChangeAgent`:

### 1. `instruction_check_system.md`
- **Файл**: `backend/prompts/instruction_check_system.md`
- **Использование**: `backend/parlant_agent.py`, строка 201
- **Назначение**: System prompt для LLM при анализе документов с инструкциями изменений
- **Содержание**: Определяет роль LLM как эксперта по анализу документов, описывает допустимые операции и требования к формату ответа

### 2. `instruction_check_user.md`
- **Файл**: `backend/prompts/instruction_check_user.md`
- **Использование**: `backend/parlant_agent.py`, строка 204
- **Назначение**: User prompt для LLM при анализе документов с инструкциями изменений
- **Содержание**: Детальные инструкции по распознаванию различных типов изменений, включая работу с таблицами, формат ответа и правила распознавания

## Промпты для применения изменений

Эти промпты созданы, но в текущей версии не используются напрямую в коде, так как применение изменений происходит через MCP инструменты:

### 3. `change_application_system.md`
- **Файл**: `backend/prompts/change_application_system.md`
- **Использование**: Не используется в текущей версии
- **Назначение**: System prompt для LLM при применении изменений к документам
- **Содержание**: Определяет роль LLM как эксперта по применению изменений

### 4. `change_application_user.md`
- **Файл**: `backend/prompts/change_application_user.md`
- **Использование**: Не используется в текущей версии
- **Назначение**: User prompt для LLM при применении изменений к документам
- **Содержание**: Инструкции по применению изменений к документу

## Загрузка промптов

Промпты загружаются через метод `_load_prompt` класса `DocumentChangeAgent`:
- **Метод**: `backend/parlant_agent.py`, строки 31-59
- **Путь к файлам**: 
  - Приоритет: `/data/prompts/` (persistent volume)
  - Fallback: `backend/prompts/` (локальная директория)
- **Инициализация**: При старте backend через `init_prompts()` в `backend/app.py`, строка 204

## Управление промптами

Промпты можно редактировать через админ-панель:
- **Раздел**: "AI Prompts" в админ-панели
- **Компонент**: `react/src/components/admin/PromptsTable.tsx`
- **API**: `backend/prompt_routes.py`
- **Отображение**: Промпты отображаются построчно в таблице с возможностью редактирования и удаления

