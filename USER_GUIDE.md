# Руководство пользователя Document Change Agent

## Содержание
1. [Введение](#введение)
2. [Начало работы](#начало-работы)
3. [Интерфейс системы](#интерфейс-системы)
4. [Загрузка документов](#загрузка-документов)
5. [Создание инструкций](#создание-инструкций)
6. [Типы операций](#типы-операций)
7. [Применение изменений](#применение-изменений)
8. [Проверка результатов](#проверка-результатов)
9. [Проверка инструкций](#проверка-инструкций)
10. [Управление файлами](#управление-файлами)
11. [Устранение неполадок](#устранение-неполадок)
12. [Часто задаваемые вопросы](#часто-задаваемые-вопросы)

---

## Введение

**Document Change Agent** — это интеллектуальная система для автоматического применения изменений к документам Microsoft Word на основе текстовых инструкций. Система использует искусственный интеллект для анализа инструкций и выполнения точных изменений в документах.

### Основные возможности:
- ✅ **Автоматическое применение изменений** к Word документам
- ✅ **Интеллектуальный анализ** текстовых инструкций
- ✅ **Поддержка различных операций**: замена текста, удаление, вставка, добавление комментариев
- ✅ **Веб-интерфейс** для удобной работы
- ✅ **Система пользователей** с персональными папками
- ✅ **История операций** и логирование


---

## Начало работы

### Вход в систему

1. Откройте веб-браузер и перейдите по адресу системы http://192.168.200.67:8080/login
2. Введите логин и пароль
3. Нажмите кнопку "Войти"

**Учетные записи по умолчанию:**
- **Пользователь**: `operator1` / `operator123`
- **Пользователь**: `operator2` / `operator123`
- **Пользователь**: `operator3` / `operator123`

### Первый запуск

После входа в систему вы увидите главную страницу с разделами:
- **Применить инструкции** — основная функция для обработки документов
- **Проверка изменений** — просмотр результатов обработки
- **Проверка инструкций** — анализ файлов с инструкциями перед обработкой
- **Управление файлами** — просмотр и удаление загруженных файлов


---

## Интерфейс системы

### Главное меню

**Применить инструкции**
- Загрузка исходного документа
- Загрузка файла с инструкциями
- Запуск обработки

**Проверка изменений**
- Просмотр обработанных документов
- Скачивание результатов
- Просмотр логов операций


### Структура файлов

Каждый пользователь имеет персональные папки:
```
/data/uploads/{username}/
├── source/     # Исходные документы
└── changes/    # Файлы с инструкциями
```

---

## Загрузка документов

### Исходные документы

1. Перейдите в раздел **"Применить инструкции"**
2. В блоке **"Исходный документ"** нажмите **"Выберите файл"**
3. Выберите Word документ (`.docx`) с вашего компьютера
4. Дождитесь завершения загрузки

**Поддерживаемые форматы:**
- `.docx` (Microsoft Word 2007+)

**Рекомендации:**
- Размер файла не должен превышать 50 МБ
- Документ должен быть в формате `.docx`


### Файлы с инструкциями

1. В блоке **"Файл с инструкциями"** нажмите **"Выберите файл"**
2. Выберите текстовый файл с инструкциями
3. Дождитесь завершения загрузки

**Поддерживаемые форматы:**
- `.docx` — Word документ с инструкциями

---

## Создание инструкций

### Общие принципы

Инструкции должны быть написаны на **русском языке** в понятной форме. Система анализирует текст и автоматически определяет необходимые операции.

### Примеры инструкций

**Замена текста:**
```
Заменить "старый текст" на "новый текст"
В пункте 5.1 заменить "было" на "стало"
```

**Удаление:**
```
Удалить пункт 3.2
Исключить раздел "Заключение"
```

**Изменение пунктов:**
```
Пункт 4.1 изложить в следующей редакции:
"Новый текст пункта 4.1"
```

**Добавление:**
```
После пункта 2.3 добавить:
"Новый пункт 2.4 с текстом"
```

**Комментарии:**
```
Добавить комментарий к пункту 1.5: "Требует уточнения"
```

### Структура файла инструкций

```
1. Заменить "компания" на "организация" во всем документе

2. Пункт 3.1 изложить в редакции:
"Новый текст для пункта 3.1"

3. Удалить пункт 4.5

4. После пункта 2.2 добавить новый пункт:
"2.3. Дополнительные требования"

5. Добавить комментарий к пункту 1.1: "Проверить актуальность данных"
```

---

## Типы операций

### 1. REPLACE_TEXT — Замена текста

**Описание:** Замена определенного текста на новый

**Примеры инструкций:**
- "Заменить 'ООО' на 'АО'"
- "В разделе 2 заменить 'должен' на 'обязан'"

**Параметры:**
- `match_case` — учитывать регистр (по умолчанию: false)
- `replace_all` — заменить все вхождения (по умолчанию: true для массовых замен)

### 2. REPLACE_POINT_TEXT — Замена содержимого пункта

**Описание:** Полная замена содержимого пункта или раздела

**Примеры инструкций:**
- "Пункт 3.1 изложить в редакции: 'новый текст'"
- "Раздел 4 изменить на: 'обновленное содержание'"

### 3. DELETE_PARAGRAPH — Удаление

**Описание:** Удаление пунктов, разделов или абзацев

**Примеры инструкций:**
- "Удалить пункт 2.5"
- "Исключить раздел 'Приложения'"

### 4. INSERT_PARAGRAPH — Вставка текста

**Описание:** Добавление нового текста после указанного места

**Примеры инструкций:**
- "После пункта 1.2 добавить: 'новый текст'"
- "Вставить после заголовка: 'дополнительная информация'"

### 5. INSERT_SECTION — Вставка раздела

**Описание:** Добавление нового раздела с заголовком

**Примеры инструкций:**
- "Добавить раздел 'Дополнительные условия'"
- "Вставить главу 'Заключительные положения'"

### 6. ADD_COMMENT — Добавление комментариев

**Описание:** Добавление комментариев к определенным частям документа

**Примеры инструкций:**
- "Добавить комментарий к пункту 1.1: 'требует проверки'"
- "Прокомментировать раздел 3: 'устаревшая информация'"

### 7. INSERT_TABLE — Вставка таблиц

**Описание:** Добавление таблиц в документ

**Примеры инструкций:**
- "После пункта 2.1 вставить таблицу:" + данные таблицы
- "Добавить таблицу с данными о сотрудниках"

---

## Применение изменений

### Запуск обработки

1. Убедитесь, что загружены оба файла:
   - ✅ Исходный документ
   - ✅ Файл с инструкциями

2. Нажмите кнопку **"Применить изменения"**

3. Дождитесь завершения обработки (может занять несколько минут)

### Процесс обработки

Система выполняет следующие шаги:

1. **Анализ инструкций** — ИИ анализирует текст и выделяет операции
2. **Валидация** — проверка корректности инструкций
3. **Применение изменений** — последовательное выполнение операций
4. **Генерация отчета** — создание детального лога операций

### Индикатор прогресса

Во время обработки отображается:
- Текущий статус операции
- Процент выполнения
- Количество обработанных инструкций

---

## Проверка результатов

### Просмотр результатов

1. Перейдите в раздел **"Проверка изменений"**
2. Выберите обработанный документ из списка
3. Нажмите **"Скачать"** для получения файла


### Анализ логов

Лог содержит информацию о каждой операции:
```json
{
  "change_id": "CHG-001",
  "operation": "REPLACE_TEXT",
  "description": "Заменить 'компания' на 'организация'",
  "status": "SUCCESS",
  "details": {
    "success": true,
    "matches_found": 5,
    "replacements_made": 5
  }
}
```

**Статусы операций:**
- `SUCCESS` — операция выполнена успешно
- `FAILED` — операция не выполнена
- `PARTIAL` — операция выполнена частично


## Устранение неполадок

### Частые проблемы

**Проблема:** Файл не загружается
**Решение:**
- Проверьте формат файла (.docx для документов)
- Убедитесь, что размер файла не превышает 50 МБ
- Попробуйте пересохранить документ в Word

**Проблема:** Инструкции не распознаются
**Решение:**
- Используйте четкие формулировки на русском языке
- Избегайте сложных конструкций
- Разбейте сложные инструкции на простые

**Проблема:** Операция не выполняется
**Решение:**
- Проверьте точность указанного текста для поиска
- Убедитесь, что текст существует в документе
- Проверьте лог операций для деталей ошибки

**Проблема:** Медленная обработка
**Решение:**
- Разбейте большой файл инструкций на несколько меньших
- Упростите сложные инструкции
- Проверьте размер исходного документа

### Коды ошибок

| Код | Описание | Решение |
|-----|----------|---------|
| `ANCHOR_NOT_FOUND` | Текст для поиска не найден | Проверьте точность указанного текста |
| `INVALID_PAYLOAD` | Неверные параметры операции | Проверьте формат инструкции |
| `REPLACE_FAILED` | Ошибка замены текста | Убедитесь, что текст существует |
| `INSERT_FAILED` | Ошибка вставки | Проверьте место вставки |
| `DELETE_FAILED` | Ошибка удаления | Убедитесь, что элемент существует |

### Получение поддержки

При возникновении проблем:
1. Проверьте логи операций
2. Сохраните сообщения об ошибках
3. Подготовьте примеры файлов
4. Обратитесь к администратору системы

---

## Часто задаваемые вопросы

**В: Какие форматы документов поддерживаются?**
О: Система работает с документами Microsoft Word в формате .docx (Word 2007 и новее).

**В: Можно ли обрабатывать документы с таблицами и изображениями?**
О: Да, система поддерживает документы с таблицами. Изображения сохраняются без изменений.


**В: Можно ли обрабатывать несколько документов одновременно?**
О: Нет, система обрабатывает документы по одному. Для массовой обработки загружайте файлы последовательно.

**В: Сохраняется ли форматирование документа?**
О: Да, система старается сохранить оригинальное форматирование. При необходимости применяются стандартные стили.


**В: Как долго хранятся обработанные файлы?**
О: Файлы хранятся в персональных папках пользователей до их ручного удаления.

**В: Как изменить пароль пользователя?**
О: Обратитесь к администратору системы для изменения пароля.

---

## Заключение

Document Change Agent — это мощный инструмент для автоматизации работы с документами. Следуя данному руководству, вы сможете эффективно использовать все возможности системы.

**Помните:**
- Всегда создавайте резервные копии важных документов
- Проверяйте результаты обработки перед использованием
- Используйте четкие и понятные инструкции
- При возникновении проблем обращайтесь к логам операций

