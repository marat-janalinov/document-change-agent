# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#—Ç–µ–∫—É—â–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. [–†–æ–ª—å LLM –≤ —Å–∏—Å—Ç–µ–º–µ](#—Ä–æ–ª—å-llm-–≤-—Å–∏—Å—Ç–µ–º–µ)
3. [–†–æ–ª—å MCP Word Server](#—Ä–æ–ª—å-mcp-word-server)
4. [–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: MCP + python-docx](#–≥–∏–±—Ä–∏–¥–Ω—ã–π-–ø–æ–¥—Ö–æ–¥-mcp--python-docx)
5. [–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è](#–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è-—Ä–∞–∑–≤–∏—Ç–∏—è)
6. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-—É–ª—É—á—à–µ–Ω–∏—é)

---

## –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±—â–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å                              ‚îÇ
‚îÇ              (React Frontend)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              FastAPI Backend                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ         DocumentChangeAgent (parlant_agent.py)        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                                                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  1. –ü–∞—Ä—Å–∏–Ω–≥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (LLM)                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     ‚îî‚îÄ> OpenAI GPT-4.1-mini                           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                                                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (MCP + python-docx)          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     ‚îú‚îÄ> MCP Server (–ø–æ–∏—Å–∫, —á—Ç–µ–Ω–∏–µ)                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     ‚îî‚îÄ> python-docx (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)                     ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                             ‚îÇ
        ‚ñº                             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MCP Server  ‚îÇ            ‚îÇ   PostgreSQL      ‚îÇ
‚îÇ  (Word)      ‚îÇ            ‚îÇ   (–õ–æ–≥–∏, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **Frontend (React)**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **Backend (FastAPI)**: API –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
3. **DocumentChangeAgent**: –ê–≥–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
4. **MCP Word Server**: –°–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Word –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
5. **OpenAI LLM**: –ü–∞—Ä—Å–∏–Ω–≥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
6. **PostgreSQL**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

## –†–æ–ª—å LLM –≤ —Å–∏—Å—Ç–µ–º–µ

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç LLM

**LLM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π** –∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON.

#### –ü—Ä–æ—Ü–µ—Å—Å –ø–∞—Ä—Å–∏–Ω–≥–∞:

```python
# 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
changes_text = await mcp_client.get_document_text(changes_file)

# 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ LLM —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏
response = await openai_client.chat.completions.create(
    model="gpt-4.1-mini",
    messages=[
        {"role": "system", "content": system_prompt},  # –ò–∑ instruction_check_system.md
        {"role": "user", "content": user_prompt},       # –ò–∑ instruction_check_user.md
    ],
    response_format={"type": "json_object"},
)

# 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ JSON
{
    "changes": [
        {
            "change_id": "CHG-001",
            "operation": "REPLACE_TEXT",
            "target": {"text": "—Å—Ç–∞—Ä—ã–π —Ç–µ–∫—Å—Ç"},
            "payload": {"new_text": "–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç"}
        },
        ...
    ]
}
```

#### –ß—Ç–æ LLM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:

- ‚úÖ **–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏** (`REPLACE_TEXT`, `DELETE_PARAGRAPH`, `INSERT_PARAGRAPH`, –∏ —Ç.–¥.)
- ‚úÖ **–¶–µ–ª–µ–≤–æ–π —Ç–µ–∫—Å—Ç** –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- ‚úÖ **–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç** –¥–ª—è –∑–∞–º–µ–Ω—ã/–≤—Å—Ç–∞–≤–∫–∏
- ‚úÖ **–ü–æ–∑–∏—Ü–∏—é** –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ (–ø–æ—Å–ª–µ –∫–∞–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞)
- ‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã** (match_case, replace_all, –∏ —Ç.–¥.)

#### –ß—Ç–æ LLM –ù–ï –¥–µ–ª–∞–µ—Ç:

- ‚ùå **–ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è** –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É
- ‚ùå **–ù–ï –∏—â–µ—Ç —Ç–µ–∫—Å—Ç** –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- ‚ùå **–ù–ï –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã**

---

## –†–æ–ª—å MCP Word Server

### –ß—Ç–æ —Ç–∞–∫–æ–µ MCP Server?

**MCP (Model Context Protocol) Word Server** ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Word –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑ HTTP API.

### ‚úÖ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MCP Server

#### 1. **–ß—Ç–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**

```python
# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
changes_text = await mcp_client.get_document_text(changes_file)
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- `parlant_agent.py:447` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- `app.py:420, 498` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

#### 2. **–ü–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ**

```python
# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –≤—Ö–æ–∂–¥–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–∞
matches = await mcp_client.find_text_in_document(
    filename,
    text_to_find="–∏—Å–∫–æ–º—ã–π —Ç–µ–∫—Å—Ç",
    match_case=True,
)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[MCPTextMatch] —Å paragraph_index –∏ text
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- `parlant_agent.py:663, 672, 684` - –¥–ª—è `REPLACE_TEXT`
- `parlant_agent.py:808, 817` - –¥–ª—è `DELETE_PARAGRAPH`
- `parlant_agent.py:899, 907, 916` - –¥–ª—è `REPLACE_POINT_TEXT`
- `parlant_agent.py:989, 997` - –¥–ª—è `INSERT_PARAGRAPH`
- `parlant_agent.py:1057` - –¥–ª—è `INSERT_SECTION`
- `parlant_agent.py:1121` - –¥–ª—è `ADD_COMMENT`

#### 3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π**

```python
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
await mcp_client.copy_document(source_file, backup_path)
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- `parlant_agent.py:443` - —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

#### 4. **–ß–∞—Å—Ç–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏**

```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ position=None)
await mcp_client.add_paragraph(filename, text, style=style)

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ position=None)
await mcp_client.add_heading(filename, text, level=level)

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
await mcp_client.add_table(filename, rows, position=position)
```

### ‚ùå –ß—Ç–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ MCP Server

–ò–∑ **54 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** MCP Server –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **3-5**:

#### –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ, –Ω–æ –ø–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

1. **`search_and_replace`** - –ó–∞–º–µ–Ω–∞ —Ç–µ–∫—Å—Ç–∞
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** (–≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `python-docx` –Ω–∞–ø—Ä—è–º—É—é)
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–¥–∞

2. **`delete_paragraph`** - –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** (–≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `python-docx` –Ω–∞–ø—Ä—è–º—É—é)
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–¥–∞

3. **`insert_line_or_paragraph_near_text`** - –í—Å—Ç–∞–≤–∫–∞ —Ä—è–¥–æ–º —Å —Ç–µ–∫—Å—Ç–æ–º
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è `INSERT_PARAGRAPH` –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏

4. **`format_text`** - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, —Ü–≤–µ—Ç)

5. **`get_all_comments`** - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

6. **`format_table`** - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü

7. **`add_footnote_*`** - –†–∞–±–æ—Ç–∞ —Å–æ —Å–Ω–æ—Å–∫–∞–º–∏
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–Ω–æ—Å–æ–∫

8. **`convert_to_pdf`** - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF
   - ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - üí° **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF

---

## –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: MCP + python-docx

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**:

1. **MCP Server** –¥–ª—è:
   - ‚úÖ –ß—Ç–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - ‚úÖ –ü–æ–∏—Å–∫–∞ —Ç–µ–∫—Å—Ç–∞
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–π

2. **python-docx** –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è:
   - ‚úÖ –ó–∞–º–µ–Ω—ã —Ç–µ–∫—Å—Ç–∞
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏—è –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤
   - ‚úÖ –í—Å—Ç–∞–≤–∫–∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

### –ü—Ä–∏–º–µ—Ä —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

```python
# REPLACE_TEXT: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MCP –¥–ª—è –ø–æ–∏—Å–∫–∞, python-docx –¥–ª—è –∑–∞–º–µ–Ω—ã
async def _handle_replace_text(self, filename: str, change: Dict[str, Any]):
    # 1. –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ MCP
    matches = await mcp_client.find_text_in_document(
        filename, target_text, match_case=match_case
    )
    
    # 2. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ python-docx
    doc = Document(filename)
    for match in matches:
        para = doc.paragraphs[match.paragraph_index]
        para.text = para.text.replace(old_text, new_text)
    doc.save(filename)
```

### –ü–æ—á–µ–º—É –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥?

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ MCP Server –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ python-docx –¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ (MCP –∏ python-docx)
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã)
- ‚ö†Ô∏è –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Å—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª MCP Server

---

## –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è

### 1. üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –ø–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Server

#### –¶–µ–ª—å: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP Server –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞ (–º–µ–Ω—å—à–µ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ python-docx)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö 54 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ MCP Server
- ‚úÖ –õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. **–ó–∞–º–µ–Ω–∏—Ç—å `REPLACE_TEXT` –Ω–∞ `search_and_replace` MCP:**
   ```python
   # –í–º–µ—Å—Ç–æ:
   doc = Document(filename)
   para.text = para.text.replace(old_text, new_text)
   doc.save(filename)
   
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
   await mcp_client.replace_text(
       filename, old_text, new_text, paragraph_index
   )
   ```

2. **–ó–∞–º–µ–Ω–∏—Ç—å `DELETE_PARAGRAPH` –Ω–∞ `delete_paragraph` MCP:**
   ```python
   # –í–º–µ—Å—Ç–æ:
   doc = Document(filename)
   self._delete_paragraph(doc.paragraphs[index])
   doc.save(filename)
   
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
   await mcp_client.delete_paragraph(filename, paragraph_index)
   ```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `insert_line_or_paragraph_near_text` –¥–ª—è `INSERT_PARAGRAPH`:**
   ```python
   # –í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –∏ –≤—Å—Ç–∞–≤–∫–∏:
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
   await mcp_client.insert_line_or_paragraph_near_text(
       filename,
       target_text=after_text,
       line_text=new_text,
       position='after'
   )
   ```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (2-3 –¥–Ω—è)

---

### 2. üé® –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –¶–µ–ª—å: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞

**–ù–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- `FORMAT_TEXT` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (–∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, —Ü–≤–µ—Ç)
- `FORMAT_PARAGRAPH` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –æ—Ç—Å—Ç—É–ø—ã)
- `FORMAT_TABLE` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
await mcp_client.format_text(
    filename,
    text_to_format="—Ç–µ–∫—Å—Ç",
    bold=True,
    italic=False,
    color="FF0000"  # –ö—Ä–∞—Å–Ω—ã–π
)

await mcp_client.format_table(
    filename,
    table_index=0,
    style="Light Grid Accent 1"
)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (3-4 –¥–Ω—è)

---

### 3. üìä –£–ª—É—á—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏

#### –¶–µ–ª—å: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏

**–ù–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- `MODIFY_TABLE` - –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü
- `FORMAT_TABLE_CELL` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —è—á–µ–µ–∫
- `MERGE_TABLE_CELLS` - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫
- `SET_TABLE_STYLE` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∏–ª—è —Ç–∞–±–ª–∏—Ü—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 15 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ MCP –¥–ª—è —Ç–∞–±–ª–∏—Ü:
await mcp_client.format_table_cell_text(
    filename,
    table_index=0,
    row=1,
    col=0,
    bold=True
)

await mcp_client.merge_table_cells(
    filename,
    table_index=0,
    start_row=0,
    start_col=0,
    end_row=0,
    end_col=1
)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –í—ã—Å–æ–∫–∞—è (5-7 –¥–Ω–µ–π)

---

### 4. üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å–æ —Å–Ω–æ—Å–∫–∞–º–∏

#### –¶–µ–ª—å: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–Ω–æ—Å–æ–∫ –∏ –∫–æ–Ω—Ü–µ–≤—ã—Ö —Å–Ω–æ—Å–æ–∫

**–ù–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- `ADD_FOOTNOTE` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–Ω–æ—Å–∫–∏
- `DELETE_FOOTNOTE` - –£–¥–∞–ª–µ–Ω–∏–µ —Å–Ω–æ—Å–∫–∏
- `CUSTOMIZE_FOOTNOTE_STYLE` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è —Å–Ω–æ—Å–æ–∫

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
await mcp_client.add_footnote_after_text(
    filename,
    text="—Ç–µ–∫—Å—Ç –¥–ª—è —Å–Ω–æ—Å–∫–∏",
    footnote_text="–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–Ω–æ—Å–∫–∏"
)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (2-3 –¥–Ω—è)

---

### 5. üîç –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

#### –¶–µ–ª—å: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (—Å–Ω–∞—á–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø–æ—Ç–æ–º –¥–µ—Ç–∞–ª–∏)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (—É—Å–ª–æ–≤–∏—è, —Ü–∏–∫–ª—ã)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–µ–π —Å –∑–∞–ø—Ä–æ—Å–æ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥:
# 1. –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–Ω–∞–π—Ç–∏ –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
changes_structure = await self._parse_structure_with_llm(changes_text)

# 2. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (—Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–∞–∂–¥—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é)
for instruction in changes_structure:
    detailed_change = await self._parse_change_details_with_llm(
        instruction, source_document_context
    )
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –í—ã—Å–æ–∫–∞—è (7-10 –¥–Ω–µ–π)

---

### 6. üß™ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –¶–µ–ª—å: –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ "–¥–æ" –∏ "–ø–æ—Å–ª–µ"
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
preview = await self._generate_preview(
    source_file, changes
)
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º "–¥–æ" –∏ "–ø–æ—Å–ª–µ"
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –í—ã—Å–æ–∫–∞—è (5-7 –¥–Ω–µ–π)

---

### 7. üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã

#### –¶–µ–ª—å: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ PDF, HTML, Markdown

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF (—á–µ—Ä–µ–∑ MCP `convert_to_pdf`)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ HTML
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:
await mcp_client.convert_to_pdf(
    filename,
    output_path="output.pdf"
)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –ù–∏–∑–∫–∞—è (1-2 –¥–Ω—è)

---

### 8. üîê –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –¶–µ–ª—å: –ó–∞—â–∏—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –ó–∞—â–∏—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–∞—Ä–æ–ª–µ–º (—á–µ—Ä–µ–∑ MCP `protect_document`)
- ‚úÖ –í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏
- ‚úÖ –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
await mcp_client.protect_document(
    filename,
    password="secure_password",
    protection_type="readOnly"
)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (3-4 –¥–Ω—è)

---

### 9. ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ LLM

#### –¶–µ–ª—å: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (Claude, Gemini, –ª–æ–∫–∞–ª—å–Ω—ã–µ)

**–£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Claude (Anthropic)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Gemini (Google)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (Ollama, LM Studio)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:
class LLMProvider(ABC):
    @abstractmethod
    async def parse_instructions(self, text: str) -> List[Dict]:
        pass

class OpenAIProvider(LLMProvider):
    ...

class ClaudeProvider(LLMProvider):
    ...
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (4-5 –¥–Ω–µ–π)

---

### 10. üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### –¶–µ–ª—å: –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –î–∞—à–±–æ—Ä–¥ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ operation_logs:
class OperationLog(Base):
    ...
    execution_time = Column(Float)  # –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    document_size = Column(Integer)  # –†–∞–∑–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
    changes_count = Column(Integer)  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    success_rate = Column(Float)     # –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (3-4 –¥–Ω—è)

---

### 11. üîÑ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### –¶–µ–ª—å: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
- ‚úÖ –í–µ—Ç–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ –ë–î:
class DocumentVersion(Base):
    __tablename__ = "document_versions"
    id = Column(Integer, primary_key=True)
    document_path = Column(String)
    version = Column(Integer)
    changes_applied = Column(JSON)
    created_at = Column(DateTime)
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –í—ã—Å–æ–∫–∞—è (7-10 –¥–Ω–µ–π)

---

### 12. üåê API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

#### –¶–µ–ª—å: REST API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ Webhooks –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ Batch API –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ GraphQL API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
@app.post("/api/v1/batch/process")
async def batch_process_documents(
    requests: List[ProcessRequest]
) -> List[ProcessResult]:
    ...
```

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** –°—Ä–µ–¥–Ω—è—è (4-5 –¥–Ω–µ–π)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –ø–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Server**
   - –£–ø—Ä–æ—Å—Ç–∏—Ç –∫–æ–¥
   - –£–ª—É—á—à–∏—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
   - –û—Ç–∫—Ä–æ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ 49 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º

2. **‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π**
   - –ü–æ–≤—ã—Å–∏—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - –£–º–µ–Ω—å—à–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

3. **‚úÖ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π**
   - –£–ª—É—á—à–∏—Ç UX
   - –°–Ω–∏–∑–∏—Ç —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫

4. **‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –†–∞—Å—à–∏—Ä–∏—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –ü–æ–∑–≤–æ–ª–∏—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

5. **‚úÖ –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏**
6. **‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF**
7. **‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MCP Server

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –í—Å–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|-----------|-------------------|--------------|-----------------|
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ | 7 | 2 | 5 |
| –ü–æ–∏—Å–∫ –∏ —á—Ç–µ–Ω–∏–µ | 2 | 1 | 1 |
| –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | 10 | 0 (—á–∞—Å—Ç–∏—á–Ω–æ 2) | 8 |
| –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | 2 | 0 | 2 |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 2 | 0 | 2 |
| –¢–∞–±–ª–∏—Ü—ã | 15 | 0 | 15 |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | 3 | 0 | 3 |
| –°–Ω–æ—Å–∫–∏ | 10 | 0 | 10 |
| –ó–∞—â–∏—Ç–∞ | 2 | 0 | 2 |
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è | 1 | 0 | 1 |
| **–ò–¢–û–ì–û** | **54** | **3-5** | **49-51** |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ~6-9%

**–í—ã–≤–æ–¥:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–∞–ª–∞—è —á–∞—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ MCP Server. –ï—Å—Ç—å –±–æ–ª—å—à–æ–π –ø—Ä–æ—Å—Ç–æ—Ä –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- ‚úÖ **LLM** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- ‚úÖ **MCP Server** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è, –ø–æ–∏—Å–∫–∞ –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **python-docx** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ö†Ô∏è **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥** —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –º–µ—Å—è—Ü–∞):**
   - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –ø–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP Server
   - –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞

2. **–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤):**
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF

3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6+ –º–µ—Å—è—Ü–µ–≤):**
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ LLM
   - API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-11-24

